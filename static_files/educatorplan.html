<!DOCTYPE html>
<html>
<!-- Educator screen 1 | Start a Plan-->
<head>
	<title>Art Museum Portal | Educator</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto">
  <link rel="stylesheet" href="../css/home.css">
  <script src="jquery-3.3.1.min.js"></script>

  <script type="text/javascript">
  // jQuery convention for running when the document has been fully loaded:
  $(document).ready(() => {
    let nextrequest; let prevrequest;
    console.log("redirecting");
    $('#next').hide(); $('#back').hide();
    if(window.localStorage.getItem('logInStatus')){
    }else{
     window.location.href="home_withBackend.html";
   }
$('#searchButton').click(() => {
  const requestURL = 'https://api.harvardartmuseums.org/object?size=10&apikey=3626f450-6473-11e9-a8d2-cd4f8edc6e52&keyword=' + $('#searchQuery').val();
  console.log(requestURL);
  console.log('making ajax request to:', requestURL);
  $.ajax({
      // all URLs are relative to http://localhost:3000/
      url: requestURL,
      type: 'GET',
      dataType : 'json', // this URL returns data in JSON format
      success: (data) => {
        console.log('You received some data!', data);

        if (data.records) {
          $('#featuredlist').empty();
          $('#featuredlist').append('<h4>Results Found: ' + data.info.totalrecords + '</h4>');
          $('#featuredlist').append('<h6>Page: ' + data.info.page + '</h6>');
          var list = new Array();
          const artresults = data.records;
          artresults.forEach((e) => {
            list.push(e.title);
          });
          for (var x=0; x<list.length; x++){
            $('#featuredlist').append('<div class="exhibit-checks"><input class="form-check-input" type="checkbox" value="" id="check' + x + '"><label class="form-check-label" for="check' + x + '">' + list[x] + '</label></div>');
          }
          $('#next').show(); $('#back').show();
          if(data.info.next) {nextrequest = data.info.next; console.log(nextrequest);}
          if(data.info.prev) {prevrequest = data.info.prev;}
        } else {
          $('#featured-exhibits').html('No results found!');
          $('#featuredlist').hide();
        }

      },
    });

    // define a generic Ajax error handler:
    // http://api.jquery.com/ajaxerror/
    $(document).ajaxError(() => {
      $('#status').html('Error: unknown ajaxError!');
    });
  }); 
  $('#next').click(() =>
          {
            if(nextrequest) {
              $.ajax({
                url: nextrequest,
                type: 'GET',
                dataType: 'json',
                success: (data) => {
                  $('#featuredlist').empty();
                  $('#featuredlist').append('<h4>Results Found: ' + data.info.totalrecords + '</h4>');
                  $('#featuredlist').append('<h6>Page: ' + data.info.page + '</h6>');
                  var list2 = new Array();
                  const artresults2 = data.records;
                  artresults2.forEach((e) => {
                    list2.push(e.title);
                  });
                  for(var x=0; x < list2.length; x++) {
                    $('#featuredlist').append('<div class="exhibit-checks"><input class="form-check-input" type="checkbox" value="" id="check' + x + '"><label class="form-check-label" for="check' + x + '">' + list2[x] + '</label></div>');
                  }
                  if(data.info.next) {nextrequest = data.info.next;}
                  if(data.info.prev) {prevrequest = data.info.prev;}
                },
              });
            }
            else {
              console.log("No Next Page");
            }
          });
          $('#back').click(() =>
          {
            if(prevrequest) {
              $.ajax({
                url: prevrequest,
                type: 'GET',
                dataType: 'json',
                success: (data) => {
                  $('#featuredlist').empty();
                  $('#featuredlist').append('<h4>Results Found: ' + data.info.totalrecords + '</h4>');
                  $('#featuredlist').append('<h6>Page: ' + data.info.page + '</h6>');
                  var list2 = new Array();
                  const artresults2 = data.records;
                  artresults2.forEach((e) => {
                    list2.push(e.title);
                  });
                  for(var x=0; x < list2.length; x++) {
                    $('#featuredlist').append('<div class="exhibit-checks"><input class="form-check-input" type="checkbox" value="" id="check' + x + '"><label class="form-check-label" for="check' + x + '">' + list2[x] + '</label></div>');
                  }
                  if(data.info.next) {nextrequest = data.info.next;}
                  if(data.info.prev) {prevrequest = data.info.prev;}
                },
              });
            }
            else {
              console.log("No Prev Page");
            }
          });
});
</script>


</head>

<body>
	<div id="status">current user</div>
	<button id = "logOutButton" class="btn btn-primary">Log out</button>
  <div class="rectangleheader">
  <h1 class="title2">Step 2: Start a Plan</h1>
</div>
  <br>
  <input type="text" placeholder="Search the museum" aria-label="Search" id="searchQuery">
  <button type="submit" value="refresh" class="btn btn-primary mb-2" id="searchButton">Search</button>
  <div class="form-check" id="featuredlist">

  </div>

  <button type="submit" class="btn btn-primary" style="margin-left:40px;" id="back"><</button><button type="submit" class="btn btn-primary" id="next">></button>

  <div id="navigation">

  </div>

  <br>
  

  <div class="back-button">
    <a href="register.html" class="btn btn-primary">< Back</a>
  </div>
  <div class="next-button">
    <a href="pathgenerate.html" class="btn btn-primary">Next ></a>
  </div>
  
</body>
</html>
